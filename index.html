<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Edward IA — Assistente Inteligente</title>
  <meta name="description" content="Edward IA — Assistente inteligente, neutro e amigável.">
  <style>
    :root{
      --bg:#ffffff;
      --panel:#f8f6f3;
      --text:#111111;
      --accent:#c69c39; /* dourado */
      --muted:#6b6b6b;
      --glass: rgba(0,0,0,0.04);
      --radius:12px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: Inter, "Segoe UI", system-ui, Arial;
      background:linear-gradient(180deg, #fff 0%, #fbfbfb 50%);
      color:var(--text);
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:24px;
    }

    .container{
      width:100%;
      max-width:920px;
      background:var(--panel);
      border-radius:18px;
      box-shadow: 0 10px 30px rgba(18,18,18,0.08);
      padding:22px;
      overflow:hidden;
      position:relative;
      border:1px solid rgba(198,156,57,0.12);
    }

    header{
      display:flex;
      gap:16px;
      align-items:center;
      margin-bottom:14px;
    }
    .logo{
      width:64px;height:64px;border-radius:14px;
      background:linear-gradient(135deg,#fff,#f7f2e6);
      display:flex;align-items:center;justify-content:center;
      border:2px solid var(--accent);
      box-shadow: inset 0 -6px 12px rgba(198,156,57,0.06);
      font-weight:700;color:var(--accent);
      font-size:22px;
    }
    h1{margin:0;font-size:28px}
    p.lead{color:var(--muted);margin:6px 0 18px}

    .chat-panel{
      display:grid;
      grid-template-columns:1fr 320px;
      gap:18px;
    }

    .chat-window{
      background:linear-gradient(180deg, rgba(255,255,255,0.6), rgba(250,248,245,0.9));
      border-radius:12px;padding:14px;height:480px;overflow:auto;
      border:1px solid var(--glass);
      display:flex;flex-direction:column;gap:12px;
    }
    .messages{flex:1;display:flex;flex-direction:column;gap:10px;padding-right:6px}
    .msg{max-width:78%;padding:10px 12px;border-radius:10px;line-height:1.45}
    .user{align-self:flex-end;background:#0f1724;color:#fff;border-radius:10px 10px 6px 10px}
    .bot{align-self:flex-start;background:rgba(198,156,57,0.06);border:1px solid rgba(198,156,57,0.15);color:var(--text)}
    .meta{font-size:12px;color:var(--muted);margin-top:6px}

    .controls{
      display:flex;gap:8px;align-items:center;margin-top:8px;
      background:transparent;
    }
    .input{
      flex:1;padding:12px;border-radius:10px;border:1px solid #e7e3da;background:#fff;
      outline:none;font-size:15px;color:var(--text);
    }
    .btn{
      background:var(--accent);color:#fff;border:none;padding:12px 16px;border-radius:10px;
      font-weight:600;cursor:pointer;
    }
    .side{
      background:#fff;border-radius:12px;padding:12px;border:1px solid var(--glass);
      display:flex;flex-direction:column;gap:12px;height:480px;
    }

    .side h3{margin:0 0 6px 0}
    .copy-row{display:flex;gap:8px}
    .copy-box{flex:1;padding:10px;border-radius:8px;border:1px dashed #eee;background:#fbfaf8;font-size:13px}
    .small{font-size:13px;color:var(--muted)}

    footer{margin-top:14px;display:flex;justify-content:space-between;align-items:center}
    a.link{color:var(--accent);text-decoration:none;font-weight:600}

    /* responsive */
    @media (max-width:880px){
      .chat-panel{grid-template-columns:1fr;gap:12px}
      .side{height:auto;order:2}
      .chat-window{height:420px}
    }

    /* typing dots */
    .dots{width:54px;height:28px;background:transparent;display:flex;align-items:center;gap:6px}
    .dots span{width:8px;height:8px;background:#ccc;border-radius:50%;opacity:0.9;animation:blink 1.2s infinite}
    .dots span:nth-child(2){animation-delay:.15s}
    .dots span:nth-child(3){animation-delay:.3s}
    @keyframes blink{0%{opacity:.2}50%{opacity:1}100%{opacity:.2}}
  </style>
</head>
<body>
  <div class="container" role="main">
    <header>
      <div class="logo">E</div>
      <div>
        <h1>Edward IA</h1>
        <p class="lead">Assistente inteligente — neutro, amigável e ultra claro nas respostas.</p>
      </div>
    </header>

    <div class="chat-panel">
      <div class="chat-window">
        <div class="messages" id="messages" aria-live="polite"></div>

        <form id="form" class="controls" onsubmit="return false">
          <input id="input" class="input" placeholder="Digite sua pergunta..." autocomplete="off" />
          <button id="sendBtn" class="btn">Enviar</button>
        </form>

        <div class="meta small">Idioma: <select id="langSelect">
          <option value="pt">Português</option>
          <option value="en">English</option>
        </select> &nbsp; • &nbsp;
        <a class="link" href="contato.html">Contato</a> · <a class="link" href="termos.html">Termos</a> · <a class="link" href="privacidade.html">Privacidade</a>
        </div>
      </div>

      <aside class="side" aria-label="painel lateral">
        <div>
          <h3>Exemplos rápidos</h3>
          <div class="small">Clique para copiar e colar no campo de entrada.</div>
          <div style="display:flex;flex-direction:column;gap:8px;margin-top:10px">
            <button class="btn" onclick="useExample('Explique como eu crio um chatbot simples em HTML e JS.')">Como criar chatbot</button>
            <button class="btn" style="background:#222;color:#fff" onclick="useExample('Resuma o que é HTML, CSS e JS em 3 frases.')">Resumo rápido</button>
            <div style="display:flex;gap:8px;margin-top:8px">
              <input id="promptCopy" class="copy-box" readonly value="">
              <button onclick="copyPrompt()" class="btn" style="background:var(--accent)">Copiar</button>
            </div>
          </div>
        </div>

        <div>
          <h3>Plataformas</h3>
          <div class="small">Links úteis para criar chatbots e hospedar</div>
          <div style="display:flex;flex-direction:column;gap:8px;margin-top:8px">
            <a class="link" href="https://platform.openai.com/" target="_blank" rel="noopener">OpenAI Platform</a>
            <a class="link" href="https://netlify.com" target="_blank" rel="noopener">Netlify — Functions & deploy</a>
            <a class="link" href="https://developer.mozilla.org" target="_blank" rel="noopener">MDN Web Docs</a>
          </div>
        </div>
      </aside>
    </div>

    <footer>
      <div class="small">© <strong>Edward IA</strong> — Feito para todos. Idiomas suportados: pt / en / outros.</div>
      <div class="small"><a class="link" href="#" id="clearBtn">Limpar</a></div>
    </footer>
  </div>

  <script>
    // --- Config ---
    const messagesEl = document.getElementById('messages');
    const inputEl = document.getElementById('input');
    const formEl = document.getElementById('form');
    const sendBtn = document.getElementById('sendBtn');
    const promptCopy = document.getElementById('promptCopy');
    const langSelect = document.getElementById('langSelect');

    let lastBotText = ''; // evita duplicar
    function addMessage(text, cls='bot') {
      // remove trailing duplicates
      if (cls === 'bot' && text === lastBotText) return;
      const d = document.createElement('div');
      d.className = 'msg ' + (cls === 'user' ? 'user' : 'bot');
      d.textContent = text;
      messagesEl.appendChild(d);
      messagesEl.scrollTop = messagesEl.scrollHeight;
      if (cls === 'bot') lastBotText = text;
    }

    function showTyping(){
      const t = document.createElement('div');
      t.className = 'msg bot';
      t.innerHTML = '<div class="dots"><span></span><span></span><span></span></div>';
      messagesEl.appendChild(t);
      messagesEl.scrollTop = messagesEl.scrollHeight;
      return t;
    }

    async function send(question){
      if (!question) return;
      addMessage(question,'user');
      inputEl.value = '';
      sendBtn.disabled = true;

      const loadingNode = showTyping();

      try {
        const res = await fetch('/.netlify/functions/chat', {
          method:'POST',
          headers:{'Content-Type':'application/json'},
          body: JSON.stringify({ question, lang: langSelect.value })
        });

        if (!res.ok) {
          const text = await res.text();
          throw new Error('Erro servidor: ' + text);
        }
        const data = await res.json();
        const reply = (data && data.reply) ? data.reply.trim() : 'Desculpe, não consegui responder agora.';
        loadingNode.remove();
        addMessage(reply,'bot');
      } catch (err){
        loadingNode.remove();
        addMessage('Erro ao se conectar com o servidor.', 'bot');
        console.error(err);
      } finally {
        sendBtn.disabled = false;
      }
    }

    // form
    sendBtn.addEventListener('click', ()=> send(inputEl.value.trim()));
    inputEl.addEventListener('keydown', e=>{
      if (e.key === 'Enter' && !e.shiftKey) { e.preventDefault(); send(inputEl.value.trim()); }
    });

    // examples
    function useExample(text){
      promptCopy.value = text;
      inputEl.focus();
      inputEl.value = text;
    }
    function copyPrompt(){
      navigator.clipboard?.writeText(promptCopy.value || '')?.then(()=> {
        alert('Prompt copiado');
      });
    }

    document.getElementById('clearBtn').addEventListener('click', e=>{
      e.preventDefault();
      messagesEl.innerHTML='';
      lastBotText='';
    });

    // inicial: mensagem de boas-vindas
    addMessage('Olá. Sou Edward IA — em que posso ajudar?','bot');
  </script>
</body>
              </html>
